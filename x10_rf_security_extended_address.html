<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" href="main.css" type="text/css" media="screen" />
</head>
<body>
<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">X10 RF Security Extended Address</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From mochad</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p><big>X10 RF Addendum</big>
</p><p>This document shows USB data packets captured from CM15A and CM19A transceivers
for various X10 RF security devices. The X10 Wireless RF protocol is well
documented in [1].  [1] describes the protocol as seen over-the-air while
this document describes the same data received from CM15A/CM19A transceivers.
</p><p>DS10A and MS10A security sensors and the KR10A remote control send 41 bit
streams vs. 32 bit streams for other RF security devices. The extra 9 bits are
additional security address bits. This information is based on observation of
DS10A, MS10A, and KR10A devices and does not come from any official X10 source.
[1] says the 9 bits have a fixed value but observations of newer devices show
the 9 bits change whenever a new security address is generated. The additional
address bits means more devices can be used without the chance of duplicate
addresses.
</p>
<table id="toc" class="toc" summary="Contents"><tbody><tr><td><div id="toctitle"><h2>Contents</h2> <span class="toctoggle">[<a id="togglelink" class="internal" href="javascript:toggleToc()">hide</a>]</span></div>
<ul>
<li class="toclevel-1"><a href="#MS10A_PIR_motion_sensor"><span class="tocnumber">1</span> <span class="toctext">MS10A PIR motion sensor</span></a></li>
<li class="toclevel-1"><a href="#DS10A_Window.2FDoor_Sensor"><span class="tocnumber">2</span> <span class="toctext">DS10A Window/Door Sensor</span></a></li>
<li class="toclevel-1"><a href="#Function.2FKey_Values"><span class="tocnumber">3</span> <span class="toctext">Function/Key Values</span></a></li>
<li class="toclevel-1"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">References</span></a></li>
</ul>
</td></tr></tbody></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="MS10A_PIR_motion_sensor" id="MS10A_PIR_motion_sensor"></a><h2> <span class="mw-headline"> MS10A PIR motion sensor </span></h2>
<p>Sample data from an MS10A captured from a CM15A. Note the CM19A produces
the same data except it does not send the first byte 0x5D. The CM19A does not
have a power line interface (PL) so it does not need to identify whether the
packet came from the PL or RF interface. The CM15A sends the extra byte since
it has both PL and RF interfaces.
</p>
<pre>   5D 29 C6 C9 0C F3 1B 00
</pre>
<pre>   5D = received from RF interface (not seen from CM19A)
   29 = RF security
</pre>
<p>The previous two bytes are generated by the controller. The following bytes are
the over-the-air transmission. See [1] for details on decoding these bytes
but be sure to note the order of the bits is reversed.
</p>
<pre>   C6 = security address 1
   C9 = XOR with previous byte must be 0x0F 
   0C = function/key
   F3 = XOR with previous byte must be 0xFF
   1B = security address 2
   00 = parity bit for previous byte.
   
</pre>
<p>The parity bit is specified by the mask 0x80. The remaining 7 bits are always
zero.
</p><p>If the total number of ones in security address 2 is even the last byte is 0x00.
If the total number of ones in security address 2 is odd the last byte is 0x80.
</p><p>In this example, 0x1B = 00011011 which has four ones so the last byte is 0x00.
</p><p>The mochad CM15A/CM19A driver/gateway decodes the packet like this.
</p>
<pre>   12/18 17:26:15 Rx RFSEC Addr: C6:1B:00 Func: Motion_alert_MS10A
</pre>
<a name="DS10A_Window.2FDoor_Sensor" id="DS10A_Window.2FDoor_Sensor"></a><h2> <span class="mw-headline"> DS10A Window/Door Sensor </span></h2>
<p>Sample data from a DS10A captured from a CM15A.
</p>
<pre>   5D 29 EF E0 81 7E 43 80
</pre>
<pre>   5D = received from RF interface (not seen from CM19A)
   29 = RF security
</pre>
<p>The previous two bytes are generated by the controller. The following bytes are
the over-the-air transmission. [1] does not mention this device but the packet
is similar to the MS10A.
</p>
<pre>   EF = security address 1
   E0 = XOR with previous byte must be 0x0F 
   81 = function/key
   73 = XOR with previous byte must be 0xFF
   43 = security address 2
   80 = parity bit for previous byte.
</pre>
<p>The mochad CM15A/CM19A driver/gateway decodes the packet like this.
</p>
<pre>   12/18 17:40:02 Rx RFSEC Addr: EF:43:80 Func: Contact_normal_min_low_DS10A
</pre>
<a name="Function.2FKey_Values" id="Function.2FKey_Values"></a><h2> <span class="mw-headline"> Function/Key Values </span></h2>
<p>Other function/key values and their meanings are shown below. min/max refer to
the position of the slide switch inside the DS10A cover. low means low battery.
The MS10A does not have a low battery indicator or a min/max switch.
</p>
<table class="wikitable">

<tbody><tr>
<th>Function/Key </th><th> Description
</th></tr>
<tr>
<td>0x0C </td><td> Motion_alert_MS10A
</td></tr>
<tr>
<td>0x8C </td><td> Motion_normal_MS10A
</td></tr>
<tr>
<td>0x04 </td><td> Contact_alert_min_DS10A
</td></tr>
<tr>
<td>0x84 </td><td> Contact_normal_min_DS10A
</td></tr>
<tr>
<td>0x00 </td><td> Contact_alert_max_DS10A
</td></tr>
<tr>
<td>0x80 </td><td> Contact_normal_max_DS10A
</td></tr>
<tr>
<td>0x01 </td><td> Contact_alert_min_low_DS10A
</td></tr>
<tr>
<td>0x81 </td><td> Contact_normal_min_low_DS10A
</td></tr>
<tr>
<td>0x05 </td><td> Contact_alert_max_low_DS10A
</td></tr>
<tr>
<td>0x85 </td><td> Contact_normal_max_low_DS10A
</td></tr>
<tr>
<td>0x06 </td><td> Arm_KR10A
</td></tr>
<tr>
<td>0x86 </td><td> Disarm_KR10A
</td></tr>
<tr>
<td>0x46 </td><td> Lights_On_KR10A
</td></tr>
<tr>
<td>0xC6 </td><td> Lights_Off_KR10A
</td></tr>
<tr>
<td>0x26 </td><td> Panic_KR10A
</td></tr></tbody></table>
<a name="References" id="References"></a><h2> <span class="mw-headline"> References </span></h2>
<p>[1]  "Data format for X-10 wireless units" by Edward Cheung, Ph.D. and Paul
Gumerman.
</p>
</body>
</html>